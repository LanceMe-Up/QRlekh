generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                     Int          @id @default(autoincrement())
  username               String
  email                  String       @unique
  phone                  String       @unique
  password               String
  role                   UserRole     @default(USER)
  verified               Boolean      @default(false)
  passwordResetRequested Boolean      @default(false)
  refreshToken           String?
  otp                    Otp[]
  qr                     QrlekhData[]
  tag                    TagName[]
}

model Otp {
  id        Int      @id @default(autoincrement())
  code      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  type      OtpType
  userId    Int
  user      User     @relation(fields: [userId], references: [id])
}

model QrlekhData {
  id        Int          @id @default(autoincrement())
  category  String
  knownFor  String
  slug      String       @unique
  image     QrlekhImage?
  location  String
  rating    Int?         @default(1)
  name      String
  desc      String
  favourite Boolean?     @default(false)
  like      Boolean?     @default(false)
  dislike   Boolean?     @default(false)
  userId    Int
  tagNameId Int?
  TagName   TagName?     @relation(fields: [tagNameId], references: [id])
  user      User         @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model QrlekhImage {
  id    Int    @id @default(autoincrement())
  image String

  qrlekhData   QrlekhData @relation(fields: [qrlekhDataId], references: [id])
  qrlekhDataId Int        @unique
}

model TagName {
  id      Int          @id @default(autoincrement())
  tagName String
  lat     Decimal?     @unique
  long    Decimal?     @unique
  userId  Int?
  User    User?        @relation(fields: [userId], references: [id])
  qr      QrlekhData[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum UserRole {
  ADMIN
  USER
  VENDOR
}

enum OtpType {
  EMAIL_VERIFICATION
  PASSWORD_RESET
}
